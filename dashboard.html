<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - AI Agent Builder</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/plotly.js/3.0.3/plotly.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-family: 'Inter', sans-serif; }
        .card-hover { transition: all 0.3s ease; }
        .card-hover:hover { transform: translateY(-4px); box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .status-active { background: linear-gradient(135deg, #48bb78 0%, #38a169 100%); }
        .status-inactive { background: linear-gradient(135deg, #e53e3e 0%, #c53030 100%); }
        .status-draft { background: linear-gradient(135deg, #d69e2e 0%, #b7791f 100%); }
    </style>
</head>
<body class="bg-gray-50 text-gray-900">
    <!-- Navigation -->
    <nav class="bg-white shadow-lg fixed w-full top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0">
                        <h1 class="text-2xl font-bold text-indigo-600">AI Agent Hub</h1>
                    </div>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="index.html" class="px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-100">Home</a>
                        <a href="create-agent.html" class="px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-100">Create Agent</a>
                        <a href="customize.html" class="px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-100">Customize</a>
                        <a href="marketplace.html" class="px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-100">Marketplace</a>
                        <a href="dashboard.html" class="px-3 py-2 rounded-md text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700">Dashboard</a>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="pt-20 min-h-screen bg-gradient-to-br from-gray-50 to-gray-100">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
            <!-- Header -->
            <div class="flex justify-between items-center mb-12">
                <div>
                    <h1 class="text-4xl font-bold text-gray-900 mb-4">Dashboard</h1>
                    <p class="text-xl text-gray-600">Manage your AI agents and monitor their performance</p>
                </div>
                <div class="flex space-x-4">
                    <button onclick="window.location.href='create-agent.html'" class="bg-indigo-600 text-white px-6 py-3 rounded-lg hover:bg-indigo-700 transition-colors">
                        <i class="fas fa-plus mr-2"></i>Create New Agent
                    </button>
                    <button onclick="refreshDashboard()" class="bg-gray-200 text-gray-700 px-6 py-3 rounded-lg hover:bg-gray-300 transition-colors">
                        <i class="fas fa-sync mr-2"></i>Refresh
                    </button>
                </div>
            </div>

            <!-- Stats Cards -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-12">
                <div class="bg-white rounded-2xl shadow-xl p-6 card-hover">
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-robot text-blue-600 text-xl"></i>
                        </div>
                        <div class="ml-4">
                            <p class="text-sm font-medium text-gray-600">Total Agents</p>
                            <p id="totalAgents" class="text-2xl font-bold text-gray-900">0</p>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-2xl shadow-xl p-6 card-hover">
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-check text-green-600 text-xl"></i>
                        </div>
                        <div class="ml-4">
                            <p class="text-sm font-medium text-gray-600">Active Agents</p>
                            <p id="activeAgents" class="text-2xl font-bold text-gray-900">0</p>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-2xl shadow-xl p-6 card-hover">
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-comments text-purple-600 text-xl"></i>
                        </div>
                        <div class="ml-4">
                            <p class="text-sm font-medium text-gray-600">Conversations</p>
                            <p id="totalConversations" class="text-2xl font-bold text-gray-900">0</p>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-2xl shadow-xl p-6 card-hover">
                    <div class="flex items-center">
                        <div class="w-12 h-12 bg-yellow-100 rounded-lg flex items-center justify-center">
                            <i class="fas fa-star text-yellow-600 text-xl"></i>
                        </div>
                        <div class="ml-4">
                            <p class="text-sm font-medium text-gray-600">Avg Rating</p>
                            <p id="avgRating" class="text-2xl font-bold text-gray-900">0.0</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Agents List -->
                <div class="lg:col-span-2">
                    <div class="bg-white rounded-2xl shadow-xl p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-bold text-gray-900">Your Agents</h2>
                            <div class="flex space-x-2">
                                <button onclick="filterAgents('all')" id="filterAll" class="px-4 py-2 rounded-lg text-sm font-medium bg-indigo-600 text-white">All</button>
                                <button onclick="filterAgents('active')" id="filterActive" class="px-4 py-2 rounded-lg text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300">Active</button>
                                <button onclick="filterAgents('draft')" id="filterDraft" class="px-4 py-2 rounded-lg text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300">Draft</button>
                            </div>
                        </div>

                        <div id="agentsList" class="space-y-4">
                            <!-- Agents will be populated by JavaScript -->
                        </div>

                        <div id="noAgentsMessage" class="text-center py-12 text-gray-500 hidden">
                            <i class="fas fa-robot text-6xl mb-4"></i>
                            <h3 class="text-xl font-semibold mb-2">No agents yet</h3>
                            <p class="mb-6">Create your first AI agent to get started</p>
                            <button onclick="window.location.href='create-agent.html'" class="bg-indigo-600 text-white px-6 py-3 rounded-lg hover:bg-indigo-700 transition-colors">
                                Create Your First Agent
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Analytics & Quick Actions -->
                <div class="space-y-8">
                    <!-- Performance Chart -->
                    <div class="bg-white rounded-2xl shadow-xl p-6">
                        <h3 class="text-xl font-bold text-gray-900 mb-4">Performance Overview</h3>
                        <div id="performanceChart" style="height: 300px;"></div>
                    </div>

                    <!-- Quick Actions -->
                    <div class="bg-white rounded-2xl shadow-xl p-6">
                        <h3 class="text-xl font-bold text-gray-900 mb-4">Quick Actions</h3>
                        <div class="space-y-3">
                            <button onclick="window.location.href='index.html#unified'" class="w-full text-left p-4 bg-purple-50 text-purple-700 rounded-lg hover:bg-purple-100 transition-colors">
                                <i class="fas fa-brain mr-3"></i>Build Unified AI
                            </button>
                            <button onclick="window.location.href='create-agent.html'" class="w-full text-left p-4 bg-indigo-50 text-indigo-700 rounded-lg hover:bg-indigo-100 transition-colors">
                                <i class="fas fa-plus mr-3"></i>Create New Agent
                            </button>
                            <button onclick="window.location.href='index.html#agents'" class="w-full text-left p-4 bg-yellow-50 text-yellow-700 rounded-lg hover:bg-yellow-100 transition-colors">
                                <i class="fas fa-users mr-3"></i>Browse All Agents
                            </button>
                            <button onclick="downloadAPK()" class="w-full text-left p-4 bg-green-50 text-green-700 rounded-lg hover:bg-green-100 transition-colors">
                                <i class="fas fa-download mr-3"></i>Download APK
                            </button>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="bg-white rounded-2xl shadow-xl p-6">
                        <h3 class="text-xl font-bold text-gray-900 mb-4">Recent Activity</h3>
                        <div id="recentActivity" class="space-y-3">
                            <!-- Activity will be populated by JavaScript -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="deleteModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-2xl p-8 max-w-md mx-4">
            <div class="text-center">
                <div class="w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="fas fa-trash text-2xl text-red-600"></i>
                </div>
                <h3 class="text-2xl font-bold text-gray-900 mb-4">Delete Agent</h3>
                <p class="text-gray-600 mb-6">Are you sure you want to delete this agent? This action cannot be undone.</p>
                <div class="flex space-x-3">
                    <button onclick="confirmDelete()" class="flex-1 bg-red-600 text-white py-3 rounded-lg hover:bg-red-700 transition-colors">
                        Delete
                    </button>
                    <button onclick="closeDeleteModal()" class="flex-1 border-2 border-gray-300 text-gray-700 py-3 rounded-lg hover:bg-gray-50 transition-colors">
                        Cancel
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Download APK function
        function downloadAPK() {
            const apkPackage = {
                name: "AI Agent Hub - Unified Platform",
                version: "2.0.0",
                package: "com.aiagenthub.unified",
                description: "Complete AI Agent Platform with 20+ agents and unified intelligence",
                features: [
                    "20+ World-Class AI Agents",
                    "Unified AI Combinations",
                    "Custom AI Builder",
                    "Interactive Demo Mode",
                    "Advanced Customization",
                    "Performance Analytics",
                    "APK Export Function",
                    "Real-time Deployment",
                    "Community Features",
                    "Cross-Platform Support"
                ],
                platform: {
                    type: "Web App",
                    framework: "HTML5/CSS3/JavaScript",
                    responsive: true,
                    offline: false,
                    pwa: true
                },
                build: {
                    date: new Date().toISOString(),
                    builder: "AI Agent Hub Platform",
                    version: "2.0.0"
                }
            };

            const dataStr = JSON.stringify(apkPackage, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = `AI_Agent_Hub_Unified_v2.0.0.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
            
            alert('üéâ AI Agent Hub APK Package downloaded successfully!\n\nThis package includes:\n‚Ä¢ Complete platform with all 20 AI agents\n‚Ä¢ Unified AI combination system\n‚Ä¢ Custom AI builder\n‚Ä¢ Interactive demo modes\n‚Ä¢ Advanced customization tools\n‚Ä¢ Performance analytics\n‚Ä¢ Community features\n\nThe APK can be converted to Android app using PhoneGap/Cordova!');
        }

        let agents = [];
        let currentFilter = 'all';
        let agentToDelete = null;

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            loadAgents();
            updateStats();
            renderAgents();
            renderChart();
            renderRecentActivity();
        });

        function loadAgents() {
            agents = JSON.parse(localStorage.getItem('agents') || '[]');
            
            // Add some sample data if no agents exist
            if (agents.length === 0) {
                const sampleAgents = [
                    {
                        id: Date.now() - 1000,
                        name: "Customer Support Bot",
                        agentType: "support",
                        description: "Handles customer inquiries and support tickets",
                        status: "active",
                        createdAt: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString(),
                        conversations: 156,
                        rating: 4.7,
                        lastActive: new Date(Date.now() - 1 * 60 * 60 * 1000).toISOString()
                    },
                    {
                        id: Date.now() - 2000,
                        name: "Sales Assistant Pro",
                        agentType: "sales",
                        description: "Qualifies leads and schedules demos",
                        status: "active",
                        createdAt: new Date(Date.now() - 14 * 24 * 60 * 60 * 1000).toISOString(),
                        conversations: 89,
                        rating: 4.5,
                        lastActive: new Date(Date.now() - 2 * 60 * 60 * 1000).toISOString()
                    },
                    {
                        id: Date.now() - 3000,
                        name: "Content Creator AI",
                        agentType: "content",
                        description: "Generates blog posts and social media content",
                        status: "draft",
                        createdAt: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000).toISOString(),
                        conversations: 0,
                        rating: 0,
                        lastActive: null
                    }
                ];
                
                localStorage.setItem('agents', JSON.stringify(sampleAgents));
                agents = sampleAgents;
            }
        }

        function updateStats() {
            const totalAgentsCount = agents.length;
            const activeAgentsCount = agents.filter(a => a.status === 'active').length;
            const totalConversationsCount = agents.reduce((sum, agent) => sum + (agent.conversations || 0), 0);
            const avgRatingValue = agents.filter(a => a.rating > 0).reduce((sum, agent) => sum + agent.rating, 0) / agents.filter(a => a.rating > 0).length || 0;

            document.getElementById('totalAgents').textContent = totalAgentsCount;
            document.getElementById('activeAgents').textContent = activeAgentsCount;
            document.getElementById('totalConversations').textContent = totalConversationsCount.toLocaleString();
            document.getElementById('avgRating').textContent = avgRatingValue.toFixed(1);

            // Animate stats
            anime({
                targets: '#totalAgents, #activeAgents, #totalConversations, #avgRating',
                scale: [0.8, 1],
                opacity: [0, 1],
                duration: 800,
                delay: anime.stagger(200),
                easing: 'easeOutQuad'
            });
        }

        function renderAgents() {
            const agentsList = document.getElementById('agentsList');
            const noAgentsMessage = document.getElementById('noAgentsMessage');
            
            let filteredAgents = agents;
            if (currentFilter !== 'all') {
                filteredAgents = agents.filter(agent => agent.status === currentFilter);
            }

            if (filteredAgents.length === 0) {
                agentsList.innerHTML = '';
                noAgentsMessage.classList.remove('hidden');
                return;
            }

            noAgentsMessage.classList.add('hidden');
            
            agentsList.innerHTML = filteredAgents.map(agent => {
                const statusClass = agent.status === 'active' ? 'status-active' : 
                                   agent.status === 'draft' ? 'status-draft' : 'status-inactive';
                const statusText = agent.status.charAt(0).toUpperCase() + agent.status.slice(1);
                
                return `
                    <div class="border border-gray-200 rounded-lg p-6 hover:border-indigo-500 transition-colors">
                        <div class="flex justify-between items-start mb-4">
                            <div class="flex-1">
                                <h3 class="text-lg font-bold text-gray-900 mb-1">${agent.name}</h3>
                                <p class="text-sm text-gray-600 mb-2">${agent.description}</p>
                                <div class="flex items-center space-x-4 text-sm text-gray-500">
                                    <span class="flex items-center">
                                        <div class="w-3 h-3 rounded-full ${statusClass} mr-2"></div>
                                        ${statusText}
                                    </span>
                                    <span>${agent.conversations || 0} conversations</span>
                                    ${agent.rating > 0 ? `<span>‚≠ê ${agent.rating}</span>` : ''}
                                </div>
                            </div>
                            <div class="flex space-x-2 ml-4">
                                ${agent.status === 'active' ? `
                                    <button onclick="toggleAgent(${agent.id})" class="p-2 text-yellow-600 hover:bg-yellow-50 rounded-lg transition-colors" title="Deactivate">
                                        <i class="fas fa-pause"></i>
                                    </button>
                                ` : agent.status === 'draft' ? `
                                    <button onclick="toggleAgent(${agent.id})" class="p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors" title="Activate">
                                        <i class="fas fa-play"></i>
                                    </button>
                                ` : `
                                    <button onclick="toggleAgent(${agent.id})" class="p-2 text-green-600 hover:bg-green-50 rounded-lg transition-colors" title="Activate">
                                        <i class="fas fa-play"></i>
                                    </button>
                                `}
                                <button onclick="editAgent(${agent.id})" class="p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors" title="Edit">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button onclick="customizeAgent(${agent.id})" class="p-2 text-purple-600 hover:bg-purple-50 rounded-lg transition-colors" title="Customize">
                                    <i class="fas fa-code"></i>
                                </button>
                                <button onclick="deleteAgent(${agent.id})" class="p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors" title="Delete">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="flex justify-between items-center text-xs text-gray-500">
                            <span>Created ${new Date(agent.createdAt).toLocaleDateString()}</span>
                            ${agent.lastActive ? `<span>Last active ${new Date(agent.lastActive).toLocaleString()}</span>` : '<span>Never activated</span>'}
                        </div>
                    </div>
                `;
            }).join('');

            // Animate agent cards
            anime({
                targets: '.border.border-gray-200',
                translateY: [20, 0],
                opacity: [0, 1],
                delay: anime.stagger(100),
                duration: 600,
                easing: 'easeOutQuad'
            });
        }

        function renderChart() {
            const activeAgents = agents.filter(a => a.status === 'active').length;
            const draftAgents = agents.filter(a => a.status === 'draft').length;
            const inactiveAgents = agents.filter(a => a.status === 'inactive').length;

            const data = [{
                values: [activeAgents, draftAgents, inactiveAgents],
                labels: ['Active', 'Draft', 'Inactive'],
                type: 'pie',
                marker: {
                    colors: ['#48bb78', '#d69e2e', '#e53e3e']
                },
                textinfo: 'label+percent',
                textposition: 'outside',
                hovertemplate: '<b>%{label}</b><br>%{value} agents<br>%{percent}<extra></extra>'
            }];

            const layout = {
                showlegend: false,
                margin: { t: 0, b: 0, l: 0, r: 0 },
                font: { family: 'Inter, sans-serif', size: 12 },
                paper_bgcolor: 'rgba(0,0,0,0)',
                plot_bgcolor: 'rgba(0,0,0,0)'
            };

            const config = {
                displayModeBar: false,
                responsive: true
            };

            Plotly.newPlot('performanceChart', data, layout, config);
        }

        function renderRecentActivity() {
            const activities = [
                { type: 'create', message: 'Created new agent', time: '2 hours ago', icon: 'fas fa-plus text-green-600' },
                { type: 'deploy', message: 'Deployed Customer Support Bot', time: '5 hours ago', icon: 'fas fa-rocket text-blue-600' },
                { type: 'conversation', message: 'Agent handled 15 conversations', time: '1 day ago', icon: 'fas fa-comments text-purple-600' },
                { type: 'update', message: 'Updated agent configuration', time: '2 days ago', icon: 'fas fa-edit text-yellow-600' }
            ];

            document.getElementById('recentActivity').innerHTML = activities.map(activity => `
                <div class="flex items-center space-x-3 p-3 bg-gray-50 rounded-lg">
                    <i class="${activity.icon}"></i>
                    <div class="flex-1">
                        <p class="text-sm font-medium text-gray-900">${activity.message}</p>
                        <p class="text-xs text-gray-500">${activity.time}</p>
                    </div>
                </div>
            `).join('');
        }

        function filterAgents(filter) {
            currentFilter = filter;
            
            // Update filter buttons
            document.querySelectorAll('[id^="filter"]').forEach(btn => {
                btn.className = 'px-4 py-2 rounded-lg text-sm font-medium bg-gray-200 text-gray-700 hover:bg-gray-300';
            });
            document.getElementById('filter' + filter.charAt(0).toUpperCase() + filter.slice(1)).className = 'px-4 py-2 rounded-lg text-sm font-medium bg-indigo-600 text-white';
            
            renderAgents();
        }

        function toggleAgent(agentId) {
            const agent = agents.find(a => a.id === agentId);
            if (agent) {
                if (agent.status === 'active') {
                    agent.status = 'inactive';
                    agent.lastActive = new Date().toISOString();
                } else {
                    agent.status = 'active';
                    agent.lastActive = new Date().toISOString();
                }
                
                localStorage.setItem('agents', JSON.stringify(agents));
                updateStats();
                renderAgents();
            }
        }

        function editAgent(agentId) {
            localStorage.setItem('editingAgentId', agentId);
            window.location.href = 'create-agent.html';
        }

        function customizeAgent(agentId) {
            localStorage.setItem('customizingAgentId', agentId);
            window.location.href = 'customize.html';
        }

        function deleteAgent(agentId) {
            agentToDelete = agentId;
            document.getElementById('deleteModal').classList.remove('hidden');
            document.getElementById('deleteModal').classList.add('flex');
        }

        function confirmDelete() {
            if (agentToDelete) {
                agents = agents.filter(a => a.id !== agentToDelete);
                localStorage.setItem('agents', JSON.stringify(agents));
                updateStats();
                renderAgents();
                agentToDelete = null;
            }
            closeDeleteModal();
        }

        function closeDeleteModal() {
            document.getElementById('deleteModal').classList.add('hidden');
            document.getElementById('deleteModal').classList.remove('flex');
        }

        function exportData() {
            const data = {
                agents: agents,
                exportDate: new Date().toISOString(),
                totalConversations: agents.reduce((sum, agent) => sum + (agent.conversations || 0), 0),
                avgRating: agents.filter(a => a.rating > 0).reduce((sum, agent) => sum + agent.rating, 0) / agents.filter(a => a.rating > 0).length || 0
            };

            const dataStr = JSON.stringify(data, null, 2);
            const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
            
            const exportFileDefaultName = `ai_agents_export_${new Date().toISOString().split('T')[0]}.json`;
            
            const linkElement = document.createElement('a');
            linkElement.setAttribute('href', dataUri);
            linkElement.setAttribute('download', exportFileDefaultName);
            linkElement.click();
            
            alert('Agent data exported successfully!');
        }

        function refreshDashboard() {
            loadAgents();
            updateStats();
            renderAgents();
            renderChart();
            renderRecentActivity();
            
            // Animate refresh
            anime({
                targets: '.card-hover',
                scale: [1, 1.02, 1],
                duration: 300,
                easing: 'easeInOutQuad'
            });
        }
    </script>
</body>
</html>